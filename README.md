# PySphinx
Создание, поддержание и валидация простой, но функциональной блокчейн-системы, которая может работать на локальном уровне.

### Название проекта: **PySphinx**
![PySphinx](images/MarkuryFLUX_01126_.png)
### Описание проекта:

**Цель проекта**:  
Цель проекта — создание, поддержание и валидация простой, но функциональной блокчейн-системы, которая может работать на локальном уровне. Эта система создает и хранит блоки с данными, проверяет целостность блоков и позволяет беспрерывно создавать новые блоки, даже после того, как лимит блоков в текущем блокчейне исчерпан (лимит в 9999 блоков). После завершения блокчейна старые блоки архивируются, и создается новый блокчейн, который продолжает цепочку.

Проект **PySphinx** предлагает гибкую, но надежную систему для создания и управления локальным блокчейном. Система поддерживает непрерывную цепочку блоков, автоматическую архивацию и проверку целостности данных, что делает ее подходящей для обучения или разработки на основе базовой блокчейн-технологии.

**Основные задачи**:
- Надежное создание блоков с данными, хешами и ссылками на предыдущие блоки.
- Валидация блоков для сохранения целостности блокчейна.
- Архивация блоков после достижения лимита в 9999 блоков.
- Создание нового блокчейна с сохранением информации о предыдущем для продолжения цепочки.

### Структура проекта:

Проект состоит из нескольких скриптов, каждый из которых выполняет определенную роль в создании, управлении и валидации блоков в блокчейне.

---

#### 1. **`create_block.py`**
**Функционал**: 
Этот скрипт отвечает за создание нового блока в текущем блокчейне. Перед созданием нового блока система проверяет целостность всей цепочки блоков и валидность последнего блока. Если валидация проходит успешно, новый блок создается, используя данные пользователя и хеш предыдущего блока.

**Ключевые функции**:
- Проверка целостности цепочки через вызов функций валидации.
- Создание нового блока и сохранение его в файл с уникальным именем.
- Если блокчейн достигает лимита в 9999 блоков, вызывается процесс архивирования и создания нового блокчейна.

---

#### 2. **`block.py`**
**Функционал**: 
Этот файл содержит основные функции для создания и валидации блоков. Блоки создаются с учетом данных пользователя, хеша блока и хеша предыдущего блока. Хеш блоков вычисляется с использованием алгоритма SHA-256, чтобы обеспечить безопасность данных и целостность цепочки.

**Ключевые функции**:
- `create_block`: Создает новый блок с хешем данных и ссылкой на предыдущий блок.
- `validate_block`: Валидирует блок, проверяя его хеш и хеш предыдущего блока.

---

#### 3. **`chain.py`**
**Функционал**: 
Содержит функции для работы с цепочкой блоков. Скрипт отвечает за проверку целостности цепочки и получение последнего валидного блока.

**Ключевые функции**:
- `check_chain_integrity`: Проверяет, что все блоки в цепочке идут последовательно и что каждый блок валиден.
- `get_last_valid_block`: Возвращает последний валидный блок в цепочке.

---

#### 4. **`validate_block.py`**
**Функционал**: 
Скрипт для валидации конкретного блока. Пользователь может запустить его для проверки конкретного блока по его имени.

**Ключевые функции**:
- `validate_block`: Проверяет, что хеш блока совпадает с вычисленным хешем данных и что хеш предыдущего блока соответствует ожиданиям.

---

#### 5. **`validate_chain.py`**
**Функционал**: 
Скрипт для полной валидации всех блоков в текущем блокчейне. Он проходит по каждому блоку в цепочке и проверяет их целостность, начиная с первого и заканчивая последним.

**Ключевые функции**:
- `validate_all_blocks`: Проверяет, что каждый блок валиден и что хеши данных и предыдущих блоков совпадают.

---

#### 6. **`blockchain_replacement.py`**
**Функционал**: 
Этот скрипт отвечает за архивирование старого блокчейна и создание нового после достижения лимита в 9999 блоков. Он архивирует файлы блокчейна, перемещает их в архивную папку, вычисляет хеш архива, а затем создает новый блокчейн, который продолжает цепочку.

**Ключевые функции**:
- `archive_blockchain`: Архивирует текущий блокчейн, перемещает блоки в архив и создает хеш архива.
- `calculate_hash`: Вычисляет хеш архива с помощью алгоритма SHA-256.
- `create_new_blockchain`: Создает первый блок нового блокчейна с информацией о предыдущем блокчейне, включая хеши и метаданные архива.

---

#### 7. **`blockchain_info.py`**
**Функционал**: 
Этот вспомогательный скрипт собирает информацию о существующих архивированных блокчейнах, чтобы можно было корректно определить, с какого номера должен начинаться следующий блокчейн.

**Ключевые функции**:
- `get_existing_blockchains`: Собирает информацию о существующих блокчейнах.
- `get_next_blockchain_start`: Определяет номер для первого блока в новом блокчейне, основываясь на предыдущем архивированном блокчейне.

---

#### 8. **`test_blockchain.py`**
**Функционал**: 
Тестовый скрипт, который автоматически создает блоки для тестирования блокчейна. Он генерирует случайные данные для блоков и добавляет их в цепочку до тех пор, пока не будет достигнут лимит блоков, после чего тестирует процесс архивирования и создания нового блокчейна.

**Ключевые функции**:
- `create_test_blockchain`: Генерирует случайные блоки для тестирования цепочки и процесса создания нового блокчейна.

---

### Логика работы проекта:

1. **Создание блоков**:
   - Каждый новый блок содержит данные, хеш этих данных и хеш предыдущего блока.
   - Блоки хранятся в текстовых файлах в папке `blockchain`, и каждый файл имеет уникальное имя, включающее номер блока и временную метку.

2. **Проверка целостности**:
   - Перед созданием каждого нового блока проверяется целостность всей цепочки. Если хотя бы один блок не проходит проверку, система выдает ошибку и не позволяет создавать новый блок.

3. **Архивирование**:
   - Когда количество блоков в текущем блокчейне достигает лимита (9999 блоков), система автоматически архивирует старые блоки, вычисляет их хеш и перемещает в архивную папку. Затем создается новый блокчейн, который продолжает цепочку с новым номером блока.

4. **Непрерывность цепочки**:
   - При создании первого блока нового блокчейна в него включается информация о предыдущем блокчейне, включая хеш последнего блока и хеш архива, что обеспечивает непрерывность цепочки.

5. **Валидация**:
   - В любой момент времени пользователь может запустить проверку цепочки, чтобы убедиться в том, что все блоки валидны и целостность данных не нарушена.

### Скрипты для установки и запуска проекта

Для автоматической установки, настройки, обновления и запуска проекта доступны два скрипта:

1. **`start.sh` (для Linux/macOS)**  
2. **`start.bat` (для Windows)**  

#### Описание действий скриптов:

1. **Клонирование или обновление репозитория**:  
   Если проект уже клонирован на локальный компьютер, скрипт проверяет наличие обновлений с помощью `git pull`. Если проекта еще нет, он будет клонирован с репозитория.

2. **Создание и активация виртуального окружения**:  
   Скрипт проверяет наличие виртуального окружения. Если оно отсутствует, создается новое виртуальное окружение, которое затем активируется. Если окружение уже существует, оно просто активируется.

3. **Проверка и установка зависимостей**:  
   Скрипт проверяет наличие всех необходимых зависимостей, указанных в файле `requirements.txt`. Если какие-то зависимости отсутствуют, они будут автоматически установлены.

4. **Создание директории `blockchain/`**:  
   Скрипт проверяет наличие папки `blockchain/`, в которой будут храниться все блоки. Если папка отсутствует, она будет создана.

5. **Запуск основного файла `PySphinx.py`**:  
   После настройки проекта и активации виртуального окружения скрипт автоматически запускает основной файл проекта `PySphinx.py`, который предоставляет пользователю меню для управления блокчейном.





